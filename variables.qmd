---
title: "Стовпчики таблиці даних (змінні)"
author: Олександр Виноградов
lang: uk-UA
format: html
editor: visual
---

## Таблиця даних і її стовчики – змінні

Дослідник заносить зібрані дані у таблиці. Наприклад:

```{r}
Дані <- readRDS("example.rds")
knitr::kable(Дані)
```

Таблиця даних в психологічному дослідженні складається зазвичай з рядків-людей і стовпчиків-змінних (тобто, виміряних характеристик чи властивостей людей). Приклад змінних: гендер, вік, відповідь на питання анкети. Які ж бувають змінні? Кількісні і якісні («фактори»). Фактори можна поділити на впорядковані і невпорядковані.

## Кількісні змінні

Кількісний вектор з послідовних цілих чисел можна створити за допомогою функції «двокрапка». Зверніть увагу на нумерацію елементів елементів вектора на початку рядків у квадратних дужках

```{r}
idno <- -10 : 50
idno
```

Довільну послідовність значень (чисел, рядків, дат, логічних значень) створюють за допомогою функції **c()** (зверніть увагу: це **латинська** літера в нижньому регістрі!)

```{r}
# Це пояснюючий коментар. Він починається символом гратки (фунта, хештега)
age <- c(16, 18, 17, 17, 17, 21, 18, 19, 19, 17)

# Так вміст об'єкту можна вивести на пристрій (наприклад, на екран або у файл)
print(age)
age
```

Змінні (вектори) іншого типу: рядки тексту, дати, логічні значення (а ще можуть бути й ніші цікаві типи, яких немає у більшості програм статистичного аналізу. Наприклад, списки).

```{r}
## Змінна, в якій зберігаються рядки
first_name <- c(
  "Андрій", "Анжела", "Божена", "Власта", "Богдан",
  "Галина", "Василь", "Гордій", "Дмитро", "Дарина"
)

## Змінна, в які зберігаються дати (наприклад, дати народження або події)
birth_date <- as.Date(
  c(
    "2008-03-24", "2006-01-29", "2007-04-12", "2007-05-15", "2007-06-02",
    "2003-07-21", "2006-09-05", "2005-10-30", "2005-11-08", "2007-12-03"
  )
)

## Змінна, в якій зберігаються логічні значення
male <- c(
  TRUE, FALSE, FALSE, FALSE, TRUE,
  FALSE, TRUE, TRUE, TRUE, FALSE
)

```

Дати, логічні значення і фактори насправді внутрішньо представлені як кількісні змінні.

## Як дати імена елементам вектора

```{r}
## Іменований вектор. Кожне значення має своє унікальне ім'я
## Нехай для Дарини вік невідомий -- значення NA

age <- c(
  Андрій = 16, Анжела = 18, Божена = 17, Власта = 17, Богдан = 17, 
  Галина = 21, Василь = 18, Гордій = 19, Дмитро = 19, Дарина = NA
)
```

Виведення вмісту вектора на пристрій (екран):

```{r}
## Це те саме, що й print(age)
age
```


Деякі змінні, які можуть приймати тільки два значення. Вони називаються *дихтомічними* або *бінарними*, можна подавати як кількісні змінні 0/1, але у них особлива роль -- їх можна розглядати одночасно і як категоріальні:


```{r}
## Створимо дихотомічну змінну Male
Male <- c(1, 0, 0, 0, 1, 0, 1, 1, 1, 0)

Male
```



Імена складових вектора можна отримати за допомогою функції **names()**. Вона повертає вектор рядкових значень (character). Цю ж функцію використовують і для того, щоб приписати імена складовим об'єкту

```{r}
names(age)
```

## Дії з кількісними векторами

```{r}
## Відхилення від середнього віку
age - 18

## Обчислення середнього арифметичного
mean(age, na.rm = TRUE)
mean(Male, na.rm = TRUE)
```

Статистичний аналіз вже можна проводити з такими змінними-векторами, головне щоб вони були однакової довжини. Наприклад, ось функції для обчислення кореляції і критерію Стьюдента:

```{r}
## Кореляція
cor.test(age, Male)


## критерій Стьюдента для незалежних сукупностей
t.test(age ~ Male)

```

## Якісні змінні чи Фактори

Створимо номінальну (тобто, категоріальну невпорядковану) змінну "Стать":

```{r}
## Перетворимо кількісну змінну на категоріальну номінальну
gender <- factor(
  x = Male,
  levels = 0:1,
  labels = c("Жінка", "Чоловік"),
  ordered = FALSE 
)

## Операції для кількісних змінних виводять попередження
mean(gender, na.rm = TRUE)

## Для категоріальних змінних можна вивести таблицю розподілу частот
table(gender)
```

Атрибути (властивості) об'єктів. У фактора gender їх три: імена спостережень, мітки рівнів (тобто, значень фактору) та клас об'єкту:

```{r}
attributes(gender)
```

Зазирнути всередину об'єкту і дізнатися його структуру можна за допомогою функції **str()**. Так, вектор gender є фактором з двома рівнями, а також має атрибут з іменем **names**.

```{r}
str(gender)
```

**Мітки змінної і значень.** Часто аналітику хочеться одночасно мати і кількісну змінну, й категоріальну в одному флаконі, щоб оперативно перемикатись між різними типами змінних при потребі. Тоді інформацію про мітки рівнів можна зберігати всередині самого об'єкту і використовувати, коли буде потрібно:

```{r}
## Питання A1 з фактору A: "Мені начхати на почуття інших"
## Номери обраних варіантів відповіді

A1 <- c(2, 2, 5, 4, 2, 6, 2, 4, 4, 2)

## Іменований вектор з мітками варіантів відповіді
val_labels <- c(
  "Дуже неточно" = 1, "Помірно неточно" = 2, "Скоріше неточно" = 3, 
  "Скоріше точно" = 4, "Помірно точно" = 5, "Дуже точно" = 6
)

attr(A1, "label") <- "Мені начхати на почуття інших"
attr(A1, "labels") <- val_labels

str(A1)
```

Тепер деякі (не всі!) функції можуть використовувати цю інформацію при виведенні результатів. Також при необхідності мітки значень можна використати для перетворення кількісної змінної на категоріальну за допомогою спеціальних функцій.

```{r}
## тут я підключаю пакет, який спочатку потрібно інсталювати
library(sjmisc, quietly = TRUE)

## Вивести інформативну таблицю частот
frq(A1)
```

Також в будь-який момент ми зможемо перетворити змінну з такими атрибутами на справній фактор (розглянемо пізніше).

## Графіки

Візуалізація розподілу кількісної змінної: коробчатий графік

```{r}
boxplot(age, horizontal = TRUE)
```

Точкова діаграма

```{r}
stripchart(
  x = age, method = "stack",
  offset = 0.5, at = 0
)
```

Точковий графік Клівленда

```{r}
dotchart(age)
```

Знайома всім стовпчикова діаграма частот

```{r}
#| fig-cap: Стовпчикова діаграма частот
#| label: fig-barplot
barplot(
  height = table(age),
  col = c("orange", "cornflowerblue")
)
```
